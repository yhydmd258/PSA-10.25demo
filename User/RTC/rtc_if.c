/******************************************************************************								
*  Name: .c
*  Description: 
*  Project: C_demo
*  Auther:  shanghai tianma
*              R&D center
*              penghu
*  MCU: S9KEAZ128AMLH
*  Comment:
******************************************************************************/		
#include "project_cfg.h" 
#ifdef RTC_MODULE

#include "derivative.h" 
#include "rtc.h"
#include "rtc_if.h"

/**********************************************************************************************
* External objects
**********************************************************************************************/


/**********************************************************************************************
* Global variables
**********************************************************************************************/

/**********************************************************************************************
* Constants and macros
**********************************************************************************************/

/**********************************************************************************************
* Local types
**********************************************************************************************/


/**********************************************************************************************
* Local function prototypes
*********************************************************************************************/

/**********************************************************************************************
* Local variables
**********************************************************************************************/


/**********************************************************************************************
* Local functions
**********************************************************************************************/


/**********************************************************************************************
* Global functions
**********************************************************************************************/
/***********************************************************************************************
*
* @brief     init RTC
* @param    none
* @return   none
*
************************************************************************************************/
void RTC_If_Init(void)
{
    RTC_ConfigType  pRTC_Config={0};
#if 1
    /* configure RTC to 1KHz(1s/(200*5us)) interrupt frequency */
    pRTC_Config.u16ModuloValue = 199; /* period number is 100 */
    pRTC_Config.bInterruptEn   = RTC_INTERRUPT_ENABLE;     /* Enable interrupt */
    pRTC_Config.bClockSource   = RTC_CLKSRC_BUS;          /* Clock source is 20Mhz */
    pRTC_Config.bClockPrescaler = RTC_CLK_PRESCALER_100;    /* Prescaler is 100, 5us every period */
#else
    /* configure RTC to 1KHz interrupt frequency */
    pRTC_Config.u16ModuloValue = 0;
    pRTC_Config.bInterruptEn   = RTC_INTERRUPT_ENABLE;     /* Enable interrupt */
    pRTC_Config.bClockSource   = RTC_CLKSRC_1KHZ;          /* Clock source is 1khz */
    pRTC_Config.bClockPrescaler = RTC_CLK_PRESCALER_100;    /* Prescaler is 100 */
#endif
	RTC_Init(&pRTC_Config);

    /* set RTC priority */
    NVIC_SetPriority(RTC_IRQn, 0);
}

/***********************************************************************************************
*
* @brief     Deinit RTC
* @param    none
* @return   none
*
************************************************************************************************/
void RTC_If_Deinit(void)
{
    RTC_DeInit();
}

/***********************************************************************************************
*
* @brief     - Program entry function
* @param    none
* @return   none
*
************************************************************************************************/
void RTC_If_Callback_Set(RTC_CallbackType callback)
{
    RTC_SetCallback(callback);
}

#endif /* RTC_MODULE */
